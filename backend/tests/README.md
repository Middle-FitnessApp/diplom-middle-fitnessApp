# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±—ç–∫–µ–Ω–¥–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ global-setup.ts          # –ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î (Docker)
‚îú‚îÄ‚îÄ helpers.ts               # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ setup.ts                 # –û—á–∏—Å—Ç–∫–∞ –ë–î –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–µ—Å—Ç–æ–º
‚îú‚îÄ‚îÄ README.md                 # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ unit/                     # Unit-—Ç–µ—Å—Ç—ã (–±–µ–∑ –ë–î)
‚îÇ   ‚îú‚îÄ‚îÄ controllers-validation.test.ts
‚îÇ   ‚îú‚îÄ‚îÄ services-utils.test.ts
‚îÇ   ‚îî‚îÄ‚îÄ middleware.test.ts
‚îú‚îÄ‚îÄ integration/              # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (—Å –ë–î)
‚îÇ   ‚îú‚îÄ‚îÄ auth-user-routes.test.ts
‚îÇ   ‚îî‚îÄ‚îÄ trainer-nutrition-progress-routes.test.ts
‚îú‚îÄ‚îÄ e2e/                      # E2E-—Ç–µ—Å—Ç—ã –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ auth-invites-nutrition.test.ts
‚îÇ   ‚îî‚îÄ‚îÄ progress-chat-notifications.test.ts
‚îú‚îÄ‚îÄ invites-trainer-client/   # –¢–µ—Å—Ç—ã –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π —Ç—Ä–µ–Ω–µ—Ä-–∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ accept-invite.test.ts
‚îÇ   ‚îú‚îÄ‚îÄ duplicate-invite.test.ts
‚îÇ   ‚îú‚îÄ‚îÄ favorites.test.ts
‚îÇ   ‚îú‚îÄ‚îÄ reject-invite.test.ts
‚îÇ   ‚îú‚îÄ‚îÄ send-invite.test.ts
‚îÇ   ‚îî‚îÄ‚îÄ clients-list.test.ts
‚îú‚îÄ‚îÄ nutrition/                # –¢–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –ø–∏—Ç–∞–Ω–∏—è
‚îî‚îÄ‚îÄ progress/                 # –¢–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
```

### –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

- **`unit/`** - Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, —Å–µ—Ä–≤–∏—Å–æ–≤, middleware (–±–µ–∑ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î)
- **`integration/`** - –¢–µ—Å—Ç—ã API —Ä–æ—É—Ç–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î
- **`e2e/`** - End-to-end —Ç–µ—Å—Ç—ã –ø–æ–ª–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ü–∏–∫–ª–∞ —Å –∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–∞
- **`invites-trainer-client/`** - –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π –º–µ–∂–¥—É —Ç—Ä–µ–Ω–µ—Ä–∞–º–∏ –∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏
- **`nutrition/`** - –¢–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –ø–ª–∞–Ω–æ–≤ –ø–∏—Ç–∞–Ω–∏—è
- **`progress/`** - –¢–µ—Å—Ç—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. **Docker** - —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π PostgreSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. **`.env.test`** - —Å–æ–∑–¥–∞–π—Ç–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** - `global-setup.ts` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

   - –ó–∞–ø—É—Å–∫–∞–µ—Ç Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å PostgreSQL
   - –ñ–¥–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ë–î
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç Prisma –º–∏–≥—Ä–∞—Ü–∏–∏
   - –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤

   ## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±—ã—Å—Ç—Ä–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ)

   1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ/–ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤:

   ```bash
   cp .env.test.example .env.test  # –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∏–º–µ—Ä
   # –∏–ª–∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `backend/.env.test` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π DATABASE_URL –∏ POSTGRES_*
   ```

   2. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –≤–∏–¥–µ—Ç—å –ë–î —Å —Ö–æ—Å—Ç–∞, —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ `ports` –≤ `backend/docker-compose.test.yml` –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ `docker-compose.override.yml` —Å:

   ```yaml
   services:
     postgres-test:
       ports:
         - '5433:5432'
   ```

   3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –ë–î –∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:

   ```bash
   # –∏–∑ –ø–∞–ø–∫–∏ backend
   docker-compose -f docker-compose.test.yml up -d
   # –∑–∞—Ç–µ–º —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–¥–æ—Ä–æ–≤
   docker ps --filter name=backend-postgres-test-1
   ```

   4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã (–≤ –∫–æ—Ä–Ω–µ `backend`):

   ```bash
   npm test
   ```

   –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:

   - –í CI –æ–±—ã—á–Ω–æ –Ω–µ –º–∞–ø–ø—è—Ç `ports` –Ω–∞ —Ö–æ—Å—Ç ‚Äî –ø–æ—ç—Ç–æ–º—É –≤ `docker-compose.test.yml` –º–∞–ø–ø–∏–Ω–≥ –ø–æ—Ä—Ç–∞ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω.
   - `global-setup.ts` —Å–∞–º –ø–æ–¥–Ω–∏–º–∞–µ—Ç/–æ–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ ‚Äî –Ω–∏—á–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ –ø—Ä–∞–≤–∏—Ç—å –Ω–µ –Ω—É–∂–Ω–æ.

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
npm test

# –ü–æ —Ç–∏–ø–∞–º
npm run test:unit        # Unit-—Ç–µ—Å—Ç—ã
npm run test:integration # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
npm run test:e2e         # E2E-—Ç–µ—Å—Ç—ã

# –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
npx vitest run tests/unit/
npx vitest run tests/integration/
npx vitest run tests/e2e/
npx vitest run tests/invites-trainer-client/
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- **Vitest** - —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º (`maxWorkers: 1`, `sequence: { concurrent: false }`)
- **Fastify** - —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `buildApp()` –∏–∑ `app.ts`
- **Prisma** - ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
- **–ò–∑–æ–ª—è—Ü–∏—è** - –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —á–∏—Å—Ç–æ–π –ë–î –±–ª–∞–≥–æ–¥–∞—Ä—è `setup.ts`
- **–•–µ–ª–ø–µ—Ä—ã** - `helpers.ts` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

- **`global-setup.ts`** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î —á–µ—Ä–µ–∑ Docker
- **`setup.ts`** - –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–µ—Å—Ç–æ–º
- **`helpers.ts`** - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç:**

- E2E: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π, –ø–∏—Ç–∞–Ω–∏—è, –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, —á–∞—Ç–æ–≤, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- Integration: –†–æ—É—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Unit: –°–µ—Ä–≤–∏—Å—ã —Ç–æ–∫–µ–Ω–æ–≤, middleware, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- Invites: –ü—Ä–∏–Ω—è—Ç–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π, –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã, –¥—É–±–ª–∏–∫–∞—Ç—ã

üîÑ **–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:**

- Nutrition: –ü–æ–ª–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–ª–∞–Ω–æ–≤ –ø–∏—Ç–∞–Ω–∏—è
- Progress: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å –ë–î
- Socket.IO –∑–∞–º–æ–∫–∞–Ω –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –æ—à–∏–±–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- Supabase —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ
- –í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ email/timestamp –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
